<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Cube</title>
<script type="text/javascript" src="js/d3.v3.min.js"></script>
<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.10.2.custom.min.js"></script>
<script type="text/javascript" src="js/search.js"></script>
<script type="text/javascript" src="js/cube.js"></script>
<link rel="stylesheet" type="text/css" media="screen" href="css/south-street/jquery-ui-1.10.2.custom.min.css" />
<style type="text/css">
.cellRect{
	color:#000000;
	fill-opacity:1;
	fill-rule:nonzero;
	stroke:none;
	stroke-width:0.30000000999999998;
	marker:none;
	visibility:visible;
	display:inline;
	overflow:visible;
	enable-background:accumulate
}
.red_face{
	fill:#c83737;
}
.blue_face{
	fill:#5599ff
}
.white_face{
	fill:#dbe2e3;
	stroke:#4d4d4d
}
.green_face{
	fill:#71c847
}
.yellow_face{
	fill:#ffd42a
}
.orange_face{
	fill:#ff7f2a
}
.faceRect{
    fill:#444444
}

</style>
</head>
<body>
<svg id="fooz" width="600" height="400">
</svg>
<pre class="result">
    
</pre>
<div class="operations" >
<span id="ok_btn">Reset</span>
<span id="solve_btn">Solve</span>
</div>
<script type="text/javascript">
    var layout;
    var problem;

    function bindClick(){
    d3.selectAll('.cellRect').on('click',function(d){
        var nodeData = d3.select(this).datum();
        
        var state = problem.getState();
        console.info(nodeData);
        var actions =  problem.getActions();
        var faceNum = nodeData[0];
        var action = actions [faceNum];
        var newState = problem.getSuccessorState(state,action);
        problem = new CubeProblem(newState);
        layout.show(newState);
        bindClick();
    });
}


	$(document).ready(function(){
		var btn = $('#ok_btn').button();
		layout = new CubeLayout('#fooz');
        problem = new CubeProblem();
		layout.show(problem.getState());
        bindClick();
        btn.click(function(){
            problem = new CubeProblem();
            layout.show(problem.getState());
            bindClick();
        });
        var solve = $('#solve_btn').button();
        solve.click(function(){
            var search = new Search();
            var strategy={
                'fringe':new Queue()
            }
            var result = search.search(problem,strategy);
            var strOut = "<";
            for(r in result){
                strOut+=result[r];
                strOut+=',';
            }
            strOut=strOut.substr(0,strOut.length-1);
            strOut+='>\n'+problem.getExpandedNodes();
            
            $('.result').text(strOut);
        });
    });
</script>
</body>
</html>